---
title: "Lab 3: Analyzing Data with Box Plots."
output: 
  html_document:
    toc: true # table of content true
    depth: 2  # up to two depths of headings (specified by #, ##)
    number_sections: false  ## if you want number sections at each table header
    theme: cerulean  # many options for theme, this one is my favorite.
    highlight: tango  # specifies the syntax highlighting style
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
fig_caption=TRUE
library(bootstrap)
library(psych)
library(ggplot2)
library(NWCEd)
library(gridExtra)
```

## Introduction
<div style="text-align:justify">
The use of graphical representations of hydrologic datasets is a common and effective way in which to communicate important information to various stakeholders such as hydrologysts, engineers, and water managers.  One commonly used geographical representation is called a **Box Plot**, or sometimes referred to as a Box and Whisker plot.  The purpose of this lab is to learn about what information these graphics contain and how to effectively use them to improve the quality of dataset.
</div>

## Important Questions to Ask Yourself

1. What information is contained in a box plot?
2. How do I interpret the quality of a dataset using a box plot?
3. Who is the intended audience I am trying to communicate information with?

## Useful Terms and Acronyms

Term               | Defintion
----------------   | ---------------------------------------------------
Box plot           | A graphical display of the distribution of data for a given dataset
Outlier            | A data point that is distinctly separate from the rest of the data
Mean               | The mean or average used to derive the central tendency of the data in question
Median             | The middle value in a list values sorted from smallest to largest
Standard Deviation | Used as a measure of the variation in a distribution
Spread             | Refers to how stretcehd or squeezed the distribution is
Kurtosis           | A measure of the "taildness" of the probability distribution
Skewness           | A measure of the asymmetry of the probability distribution
Quartile           | The median of either the upper or lower half of a dataset after the dataset has been ordered and and separated into two groups
Stakeholder        | A person or group that has an interest or concern

## Exercise 1 

<br>

#### Step 1
<div style="text-align:justify">
The purpose of Exercise 1 is to walk through the process of obtaining an HUC ID for a desired watershed.  The HUC ID is entered as an argument into the **getNWCData** function which brings in the hydrologic datasets associated with the specified watershed.  Once the datasets are downloaded, we can use a plotting function in the **ggplot2** library to create desired box plots for statistical analysis.  

To begin, log on to the National Water Census Data Portal (NWC-DP) using the following URL: <http://cida.usgs.gov/nwc/>.  The home page is shown in **Figure 1** below.  Click on the tab titled, "Water Budget" in the Menu ribbon on the left of the page or anywhere in the large Water Budget icon to access the Water Budget tool.
</div>
<br>

![**Figure 1: The NWC-DP homepage.**](/Research/RStudioProject/NWCEd/inst/Lab3_NWC-DP_Images/Figure1.jpg)

<br>
<div style="text-align:justify">
Toggle **`Huc Layer:`** to **12 Digit**.  Note that both 12 Digit and 8 Digit HUC ID's can work.  For this exercise we will use a 12 Digit HUC ID.  In the search bar, type "Denver" and then select "Denver County CO Denver County".  Zoom out until you are able to clearly view the delineated watersheds.  Select the watershed which largly encompasses Denver, Colorado as shown in **Figure 2**.   
</div>
<br>

![**Figure 2: Selecting an HUC which encompasses Denver, Colorado.**](/Research/RStudioProject/NWCEd/inst/Lab3_NWC-DP_Images/Figure2.jpg)

<br>
<div style= "width: 450px; height= 300px;PADDING-RIGHT: 5px; float: left">![**Figure 3: Viewing  HUC ID for Cherry Creek-South Platte River watershed.**](/Research/RStudioProject/NWCEd/inst/Lab3_NWC-DP_Images/Figure3.jpg)
</div>
<div style="text-align:justify">
After clicking on the watershed, a new page opens as shown in **Figure 3** to the left.  The associated HUC ID is displayed both in the center of the screen as well as in the upper-left corner of the page.  For this watershed, the HUC ID is **101900030304**.  For more information about the features and functionality of this page or other NWC-DP pages, please see **Lab 1**.  With the HUC ID obtained, we are ready to proceed to the next step.
</div>

<br>
<div style="text-align:justify; clear: left">
 
#### Step 2
<div style="text-align:justify">
With the HUC ID obtained, we are ready to download the data and create our box plots.  For this lab, the box plots have already been produced using the datasets associated with HUC #101900030304.  For reproduction of results, please see the **Lab_3.Rmd** file under the **inst** folder in the **NWCEd** package for embedded code.  Embedded code can be run in the RStudio console.  Below each plot is a printed summary of the associated analysis.


```{r,fig.align='center',out.extra='angle=90', echo=FALSE}
getdata <- getNWCData(huc="101900030304")
getetdata <- getdata[[1]]
annualgetetdata <- annualize(getetdata, method = "sum")
ggplot(annualgetetdata, aes("var", data)) + geom_boxplot(fill = "#009E73", color = "black", outlier.colour = "red", outlier.shape = 16, outlier.size = 2) + xlab("") + ylab("ET (mm per year)") + scale_x_discrete(breaks = NULL) + ggtitle("ET for HUC 101900030304")
```

<br>

```{r,fig.align='center',out.extra='angle=90', echo=FALSE}
describe(annualgetetdata[[2]])
```

<br>

<div style="text-align:justify">
The ET box plot above shows the center of the data, the **spread** or variation, the **skewness**, and any **outliers**.  Looking just at ET box plot, are there any outliers?  What is the value of the first quartile?  The third quartile?  There are no outliers.  The first quartile is 299.5. The third quartile is 318.5.  The values of approximately 75% of the data are 318.5mm and below.  Only 25% of the data analyzed was less than or equal to 299.5mm.  What is the skew of the plot?  This may be difficult to see.  Lets rotate the plot to better see the skew.

<br>

```{r,fig.align='center',out.extra='angle=90', echo=FALSE}
getdata <- getNWCData(huc="101900030304")
getetdata <- getdata[[1]]
annualgetetdata <- annualize(getetdata, method = "sum")
ggplot(annualgetetdata, aes("var", data)) + coord_flip() + geom_boxplot(fill = "#009E73", color = "black", outlier.colour = "red", outlier.shape = 16, outlier.size = 2) + xlab("") + ylab("ET (mm per year)") + scale_x_discrete(breaks = NULL) + ggtitle("ET for HUC 101900030304")
```

<br>

The rotation on the box plot makes it much easier to see that shape of the data is skewed left.  This means that the area under the left tail of the probability curve is less than the area under the right tail.  Below is a comparison between the ET box plot and the ET histogram.

<br>

<div style= "width: 450px; height= 300px; float: left">
```{r,fig.align='center',out.extra='angle=90', echo=FALSE}
getdata <- getNWCData(huc="101900030304")
getetdata <- getdata[[1]]
annualgetetdata <- annualize(getetdata, method = "sum")
ggplot(annualgetetdata, aes("var", data)) + coord_flip() + geom_boxplot(fill = "#009E73", color = "black", outlier.colour = "red", outlier.shape = 16, outlier.size = 2) + xlab("") + ylab("ET (mm per year)") + scale_x_discrete(breaks = NULL) + ggtitle("ET for HUC 101900030304")
```
</div><div style= "width: 450px; height= 300px; float: right">
![](/Research/RStudioProject/NWCEd/inst/Lab3_NWC-DP_Images/Figure4.jpg)
</div>

<br>
<div style="text-align:justify; clear: left">
You can see in the histogram that just more than half of the data sits right of center.  According to the summary printout, the **mean** is 307.53.  The **standard deviation** is found to be 15.3 from the same printout.  ET values that fall within 1 standard deviation or +/- 15.3 are considered to be "normal".  According to the printout, how many many data points were included in the analysis?  _Hint: What is n?_  Do you think this value represents the sample size or the population size?
</div>

<br>

Look at the precipitation box plot below.  How does it compare to the previous box plot?

<br>
```{r,fig.align='center',out.extra='angle=90',echo=FALSE}
getdata <- getNWCData(huc="101900030304")
getprcpdata <- getdata[[2]]
annualgetprcpdata <- annualize(getprcpdata, method = "sum")
ggplot(annualgetprcpdata, aes("var", data)) + geom_boxplot(fill = "#56B4E9", color = "black", outlier.colour = "red", outlier.shape = 19, outlier.size = 2) + xlab("") + ylab("Precipitation (mm per year)") + scale_x_discrete(breaks = NULL) + ggtitle("Precipitation for HUC 101900030304")
```

<br>

```{r,fig.align='center',out.extra='angle=90', echo=FALSE}
describe(annualgetprcpdata[[2]])
```

<br>

<div style="text-align:justify">
Now lets compare these box plots side by side.

<br>

```{r,fig.align='center',out.extra='angle=90', echo=FALSE}
annualetgraph <- ggplot(annualgetetdata, aes("var", data)) + coord_flip() + geom_boxplot(fill = "#009E73", color = "black", outlier.colour = "red", outlier.shape = 16, outlier.size = 2) + xlab("") + ylab("ET (mm per year)") + scale_x_discrete(breaks = NULL) + ggtitle("ET for HUC 101900030304")
annualprcpgraph <- ggplot(annualgetprcpdata, aes("var", data)) + coord_flip() + geom_boxplot(fill = "#56B4E9", color = "black", outlier.colour = "red", outlier.shape = 19, outlier.size = 2) + xlab("") + ylab("Precipitation (mm per year)") + scale_x_discrete(breaks = NULL) + ggtitle("Precipitation for HUC 101900030304")
grid.arrange(annualetgraph, annualprcpgraph, ncol = 2)
```

<br>

How 
